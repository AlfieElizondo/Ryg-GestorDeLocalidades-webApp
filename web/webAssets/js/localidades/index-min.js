function generarSelected(){$(".plugin-selective-tareas").each(function(){var a=$(this),e=a.data("localidad");a.selective({closeOnSelect:!0,namespace:"addMember",selected:a.data("json"),local:$("#json-colaboradores-"+e).data("colaboradores"),onAfterSelected:function(a){},onAfterItemAdd:function(e){var t=a.data("id"),r=a.val();$('*[data-tareakey="'+t+'"] .addMember-trigger-button').hide(),$.ajax({url:baseUrl+"localidades/asignar-usuarios-tareas",data:{idT:t,idU:r},dataType:"json",type:"POST",success:function(a){"success"==a.status&&($(".js_btn_eliminar_tarea-"+t).remove(),console.log("Asignacion de tarea correcta"))}})},onAfterItemRemove:function(e){var t=a.data("id"),r=a.val();0==r.length&&(r=-1),$('*[data-tareakey="'+t+'"] .addMember-trigger-button').show(),$.ajax({url:baseUrl+"localidades/remover-asignacion-tarea",data:{idT:t,idU:r},dataType:"json",type:"POST",success:function(a){"success"==a.status&&console.log("Eliminacion correcta")}})},buildFromHtml:!1,tpl:{optionValue:function a(e){return e.id},frame:function a(){return'<div class="'+this.namespace+'">                '+this.options.tpl.items.call(this)+'                <div class="'+this.namespace+'-trigger">                '+this.options.tpl.triggerButton.call(this)+'                <div class="'+this.namespace+'-trigger-dropdown">                '+this.options.tpl.list.call(this)+"                </div>                </div>                </div>"},triggerButton:function e(){var t="block";if(a.data("json").length>0)var t="none";return'<div style="display:'+t+'" class="'+this.namespace+'-trigger-button"><i class="wb-plus"></i></div>'},listItem:function a(e){return'<li class="'+this.namespace+'-list-item"><img class="avatar" src="'+e.avatar+'">'+e.name+"</li>"},item:function a(e){return'<li class="'+this.namespace+'-item"><img class="avatar" src="'+e.avatar+'" data-toggle="tooltip" data-original-title="'+e.name+'">'+this.options.tpl.itemRemove.call(this)+"</li>"},itemRemove:function a(){return'<span class="'+this.namespace+'-remove"><i class="wb-minus-circle"></i></span>'},option:function a(e){return'<option value="'+this.options.tpl.optionValue.call(this,e)+'">'+e.name+"</option>"}}})}),$("body").tooltip({selector:"[data-toggle=tooltip]"})}function completarTarea(a,e){return swal({title:"Confirmación",text:"¿Estas seguro de marcar esta tarea como completada?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-warning",confirmButtonText:"Sí, esta completa",cancelButtonText:"No",closeOnConfirm:!0},function(){e.prop("checked",!0),$.ajax({url:baseUrl+"tareas/completar-tarea?token="+a,success:function(a){"success"==a.status||swal("Espera","Ocurrio un problema","error")},error:function(){swal("Espera","Ocurrio un problema","error")}})}),e.prop("checked",!1),!1}function noCompletarTarea(a,e){return swal({title:"Confirmación",text:"¿Estas seguro de marcar esta tarea como incompleta?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-warning",confirmButtonText:"Sí",cancelButtonText:"No",closeOnConfirm:!0},function(){e.prop("checked",!1),$.ajax({url:baseUrl+"tareas/descompletar-tarea?token="+a,success:function(a){"success"==a.status||swal("Espera","Ocurrio un problema","error")},error:function(){swal("Espera","Ocurrio un problema","error")}})}),e.prop("checked",!0),!1}$(document).ready(function(){$(".panel-listado-acctions a").on("click",function(){$(this).trigger("blur")}),$(".js-icon-edit").on("click",function(){$(".form-label").hide(),$(".form-input").show(),alert()}),$(".js-icon-save").on("click",function(){$(".form-input").hide(),$(".form-label").show(),alert()}),$(".img.avatar").tooltip("option","classes.algo","highlight"),$(".run-slide-panel").slidePanel({closeSelector:".slidePanel-close",template:function a(e){return'<div class="'+e.classes.base+" "+e.classes.base+"-"+e.direction+'">\n                  <div class="'+e.classes.base+'-scrollable">\n                    <div><div class="'+e.classes.content+'"></div></div>\n                  </div>\n                  <div class="'+e.classes.base+'-handler"></div>\n                </div>'},pointerDrag:!1,mouseDrag:!1,afterLoad:function(a){$(".slidePanel-scrollable").asScrollable({namespace:"scrollable",contentSelector:">",containerSelector:">"}),$('*[data-plugin="dropify"]').dropify(),generarSelected()}}),$(document).on({click:function(a){a.preventDefault();var e=$(this).data("id"),t=$("#form-tarea-"+e);if(t.find(".file_tarea")&&""==$("#form-tarea-"+e+" .file_tarea").val())return swal("Espera","Debes agregar un archivo","warning"),!1;t.submit()}},".submit_tarea"),$(document).on({change:function(){var a=$(this).parents("form"),e=a.find(".submit_tarea");e.show(),""==$(this).val()&&e.hide()}},"#wrktareas-txt_tarea"),$(document).on({change:function(){var a=$(this).data("id"),e=$(this).val();$.ajax({type:"POST",url:baseUrl+"tareas/cambiar-nombre?id="+a,data:{nombre:e},success:function(a){"error"==a.status&&swal("Espera","Ocurrio un error, intenta de nuevo","warning")},error:function(){swal("Espera","Ocurrio un error, intenta de nuevo","warning")}})}},".js-editar-nombre-tarea"),$(document).on({change:function(){var a=$(this).parents("form"),e=a.find(".submit_tarea");e.show(),""==$(this).val()&&e.hide()}},"#wrktareas-file"),$(document).on({submit:function(a){a.preventDefault();var e=new FormData(this),t=$(this).find(".submit_tarea"),r=Ladda.create(t.get(0));r.start(),$.ajax({type:"POST",url:baseUrl+$(this).attr("action"),data:e,cache:!1,contentType:!1,processData:!1,success:function(a){"success"==a.status?(swal("Perfecto",a.message,"success"),console.log(a),a.result.url&&($(".js_descargar_archivo-"+a.result.idT+" .url_documento").html(a.result.url),$(".dropify-clear").trigger("click"))):swal("Espera",a.message,"error"),r.stop()},error:function(a,e,t){swal("Espera","Ocurrio un problema: "+e,"error"),r.stop()}})}},".formClass")}),$(window).on("load",function(){if(window.location.href.search("tokenLoc")>0){var a=location.search.split("tokenLoc=")[1];$("#js_ver_localidades_"+a).click()}}),$(document).on({click:function(a){var e=$(this).data("token");$("#wrktareas-id_localidad").val(e),$("#modal-crear-tarea").modal("show")}},".js-open-modal-tarea"),$(document).on({beforeSubmit:function(){var a=Ladda.create(document.getElementById("js-btn-guardar-tarea"));a.start();var e=$("#form-guardar-tarea").serialize();return $.ajax({url:baseUrl+"tareas/crear-tarea",data:e,method:"POST",success:function(e){"success"==e.status?($("#modal-crear-tarea").modal("hide"),document.getElementById("form-guardar-tarea").reset(),$(".js-tareas-contenedor-"+$("#wrktareas-id_localidad").val()+" h2").remove(),$(".js-tareas-contenedor-"+$("#wrktareas-id_localidad").val()).append(e.result),generarSelected()):swal("Espera","Ocurrio un problema","error"),a.stop()},error:function(){swal("Espera","Ocurrio un problema","error"),a.stop()}}),!1}},"#form-guardar-tarea"),$(document).on({change:function(a){var e=$(this),t=e.data("token");e.prop("checked")?completarTarea(t,e):noCompletarTarea(t,e)}},".js-completar-tarea"),$(document).on({click:function(a){a.preventDefault();var e=$("#motivo_archivar_localidad").val(),t=$("#url_loc").val();swal({title:"Confirmación",text:"¿Estas seguro de archivar esta localidad?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-warning",confirmButtonText:"Sí, archivar",cancelButtonText:"No",closeOnConfirm:!0},function(){$.ajax({url:baseUrl+t+"&mot="+e,success:function(a){"success"==a.status?$('tr[data-key="'+a.message+'"]').remove():swal("Espera","Ocurrio un problema","error")},error:function(){swal("Espera","Ocurrio un problema","error")}})})}},"#js_aceptar_archivar"),$(document).on({click:function(){$("#myModal").modal("show"),$("#url_loc").val($(this).data("url"))}},".js_archivar_localidad"),$(document).on({click:function(){var a=$(this).data("url");$.ajax({url:baseUrl+a,success:function(a){"success"==a.status?$('tr[data-key="'+a.message+'"]').remove():swal("Espera","Ocurrio un problema","error")},error:function(){swal("Espera","Ocurrio un problema","error")}})}},".js_desarchivar_localidad"),$(document).on({change:function(){$(".js_eliminar_tarea").remove()}},".plugin-selective-tareas"),$(document).on({click:function(){var a=$(this).data("id");$.ajax({url:baseUrl+"tareas/eliminar-tarea?id="+a,success:function(e){"success"==e.status&&$(".js-tarea-"+a).remove()},error:function(){}})}},".js_btn_eliminar_tarea");